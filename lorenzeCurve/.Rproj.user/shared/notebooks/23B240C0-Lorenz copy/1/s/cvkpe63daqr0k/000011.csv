"0","cleaned_data <- na.omit(data)"
"0",""
"0","data <- cleaned_data %>% filter(inctot != 9999998 & inctot <= 9999997)"
"0","summary(data) "
"1",""
"1","    country     "
"1","      year     "
"1","     inctot      "
"1","
"
"1"," Min.   : 76.0  "
"1"," Min.   :2000  "
"1"," Min.   :-43835  "
"1","
"
"1"," 1st Qu.:124.0  "
"1"," 1st Qu.:2000  "
"1"," 1st Qu.:     0  "
"1","
"
"1"," Median :630.0  "
"1"," Median :2000  "
"1"," Median :  1420  "
"1","
"
"1"," Mean   :544.6  "
"1"," Mean   :2001  "
"1"," Mean   : 13272  "
"1","
"
"1"," 3rd Qu.:840.0  "
"1"," 3rd Qu.:2001  "
"1"," 3rd Qu.: 15891  "
"1","
"
"1"," Max.   :862.0  "
"1"," Max.   :2005  "
"1"," Max.   :902400  "
"1","
"
"0"," "
"0","summary(data %>% filter(country == 862))"
"1",""
"1","    country   "
"1","      year     "
"1","     inctot      "
"1","
"
"1"," Min.   :862  "
"1"," Min.   :2001  "
"1"," Min.   :   0.0  "
"1","
"
"1"," 1st Qu.:862  "
"1"," 1st Qu.:2001  "
"1"," 1st Qu.:   0.0  "
"1","
"
"1"," Median :862  "
"1"," Median :2001  "
"1"," Median :   0.0  "
"1","
"
"1"," Mean   :862  "
"1"," Mean   :2001  "
"1"," Mean   : 118.9  "
"1","
"
"1"," 3rd Qu.:862  "
"1"," 3rd Qu.:2001  "
"1"," 3rd Qu.: 158.0  "
"1","
"
"1"," Max.   :862  "
"1"," Max.   :2001  "
"1"," Max.   :9100.0  "
"1","
"
"0","#create a variable for the row numbe "
"0","country_results <- data %>%"
"0","  group_by(country) %>%  # Group by country"
"0","  arrange(inctot, .by_group = TRUE) %>%  # Sort income within each country"
"0","  mutate("
"0","    inc_percent = inctot / sum(inctot, na.rm = TRUE),  # Income as percentage of total"
"0","    cum_inc_percent = cumsum(inc_percent),  # Cumulative income percentage"
"0","    pop_percent = 1 / n(),  # Population percentage for each observation"
"0","    cum_pop_percent = cumsum(pop_percent)  # Cumulative population percentage"
"0","  )"
"0",""
"0",""
"0",""
"0","# Summarise statistics for each country"
"0","country_summary <- data %>%"
"0","  group_by(country) %>%"
"0","  summarise("
"0","    min_inctot = min(pop_percent, na.rm = TRUE),"
"0","    max_inctot = max(pop_percent, na.rm = TRUE),"
"0","    count = n()  # Number of observations"
"0","  )"
"1","[1m[33mError[39m in `summarise()`:[22m
[38;5;250m[36mâ„¹[38;5;250m In argument: `min_inctot = min(pop_percent, na.rm = TRUE)`.
[36mâ„¹[38;5;250m In group 1: `country = 76`.[39m
[1mCaused by error:[22m
[33m![39m object 'pop_percent' not found
Backtrace:
[90m  1. [39mdata %>% group_by(country) %>% ...
[90m  3. [39m[1m[94mdplyr:::summarise.grouped_df([39m[22m...[1m[94m)[39m[22m
[90m  4. [39mdplyr:::summarise_cols(.data, dplyr_quosures(...), by, ""summarise"")
[90m  6. [39mdplyr:::map(quosures, summarise_eval_one, mask = mask)
[90m  7. [39m[1mbase[22m::lapply(.x, .f, ...)
[90m  8. [39m[1mdplyr[22m (local) FUN(X[[i]], ...)
[90m  9. [39mmask$eval_all_summarise(quo)
[90m 10. [39m[1mdplyr[22m (local) eval()
"
